<!DOCTYPE html>
<html lang="en" class="dark-mode">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="-5DVEpIpmk8eTZ8O0iN20xTsrb1R0ToAjHGyL3HgUTA" />
    <meta name="keywords"
        content="khurja, khurjax, khurja city, khurja digital hub, khurja business directory, khurja local business, khurja services, khurja shops, khurja market, khurja pottery, khurja ceramics, khurja startup, khurja news, khurja updates, khurja online platform, khurja ecommerce, khurja food delivery, khurja restaurants, khurja fast food, khurja freelancers, khurja web developer, khurja app developer, bulandshahr business, bulandshahr directory, uttar pradesh local business">
    <meta name="description"
        content="KhurjaX is Khurja's digital hub to find local businesses, shops, services, restaurants, freelancers, pottery market, and daily city updates in one place.">
    <title>KhurjaX - Khurja ka Digital Hub</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700;800&display=swap" rel="stylesheet">
    <style>
        /* --- GLOBAL CSS --- */
        :root {
            --primary: #2563eb;
            --bg: #f3f4f6;
            --text: #1f2937;
            --white: #ffffff;
            --green: #10b981;
            --dark: #0f172a;
        }

        /* Dark mode */
        html.dark-mode {
            --primary: #60a5fa;
            --bg: #0f172a;
            --text: #e5e7eb;
            --white: #1e293b;
            --dark: #e5e7eb;
        }

        /* Dark mode button & text fixes */
        html.dark-mode .cat-btn {
            background: #334155;
            color: #e5e7eb;
            border-color: #475569;
        }

        html.dark-mode .cat-btn.active {
            background: #60a5fa;
            color: #0f172a;
            border-color: #60a5fa;
        }

        html.dark-mode .cat-btn.all-btn {
            background: #1e293b;
            color: #e5e7eb;
            border-color: #475569;
        }

        html.dark-mode .sub-btn {
            background: #334155;
            color: #e5e7eb;
        }

        html.dark-mode .sub-btn.active {
            background: #60a5fa;
            color: #0f172a;
        }

        html.dark-mode .controls {
            background: #1e293b;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        html.dark-mode .search-box {
            background: #334155;
            color: #e5e7eb;
            border-color: #475569;
        }

        html.dark-mode .search-box:focus {
            border-color: #60a5fa;
        }

        html.dark-mode .card {
            background: #1e293b;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        html.dark-mode .card-title {
            color: #e5e7eb;
        }

        html.dark-mode .card-desc {
            color: #a0aec0;
        }

        html.dark-mode .related-box {
            background: #334155;
        }

        html.dark-mode .related-head {
            color: #e5e7eb;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            padding-bottom: 20px;
        }

        /* HEADER */
        header {
            color: var(--white);
            border-bottom-left-radius: 30px;
            border-bottom-right-radius: 30px;
            text-align: center;
            height: 250px;
            position: relative;
            overflow: hidden;
        }

        .banner-slider {
            width: 100%;
            height: 100%;
            position: relative;
        }

        .banner-slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 1s ease-in-out;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .banner-slide.active {
            opacity: 1;
        }

        .banner-slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .banner-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 2;
            color: white;
            font-size: 3.5rem;
            font-weight: 900;
            letter-spacing: 2px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
        }

        .banner-indicators {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 3;
            display: flex;
            gap: 10px;
        }

        .banner-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            cursor: pointer;
        }

        .banner-indicator.active {
            background: white;
        }

        /* THEME TOGGLE */
        .theme-toggle {
            position: absolute;
            top: 15px;
            right: 15px;
            z-index: 20;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.4);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s;
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.4);
            transform: scale(1.1);
        }

        /* HEART ANIMATION */
        @keyframes floatingHeart {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }

            50% {
                transform: translateY(-60px) scale(1.2);
                opacity: 1;
            }

            100% {
                transform: translateY(0) scale(1);
                opacity: 0;
            }
        }

        .floating-heart {
            position: fixed;
            font-size: 2rem;
            pointer-events: none;
            z-index: 9999;
            animation: floatingHeart 0.8s ease-out forwards;
        }

        /* CONTROLS */
        .controls {
            max-width: 1000px;
            margin: -80px auto 20px auto;
            padding: 20px;
            background: var(--white);
            border-radius: 20px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.08);
            position: relative;
            z-index: 5;
        }

        /* YOUTUBE-LIKE SHELVES START */
        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px 0 10px 0;
            margin-top: 10px;
            border-bottom: 2px solid rgba(0, 0, 0, 0.05);
        }

        .section-header h2 {
            font-size: 1.4rem;
            font-weight: 800;
            color: var(--text);
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-header .view-all-btn {
            background: none;
            border: none;
            color: var(--primary);
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
        }

        .scroll-tray {
            display: grid;
            grid-auto-flow: column;
            grid-auto-columns: 85%;
            /* Shows part of next card to encourage scroll */
            gap: 15px;
            overflow-x: auto;
            overscroll-behavior-inline: contain;
            padding: 10px 5px 20px 5px;
            /* Bottom padding for shadow */
            scroll-snap-type: x mandatory;
            scrollbar-width: none;
            /* Firefox */
        }

        .scroll-tray::-webkit-scrollbar {
            display: none;
            /* Chrome/Safari */
        }

        .scroll-tray .card {
            scroll-snap-align: start;
            width: 100%;
            /* Fill the grid column */
            margin: 0;
        }

        /* Tablet/Desktop tweaks */
        @media (min-width: 600px) {
            .scroll-tray {
                grid-auto-columns: 300px;
            }
        }

        /* YOUTUBE-LIKE SHELVES END */

        .search-box {
            width: 100%;
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 1rem;
            outline: none;
            transition: 0.3s;
        }

        .search-box:focus {
            border-color: var(--primary);
        }

        /* CATEGORIES SCROLL */
        .main-cats {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            padding: 15px 0;
        }

        .main-cats::-webkit-scrollbar {
            display: none;
        }

        .cat-btn {
            white-space: nowrap;
            padding: 10px 20px;
            border-radius: 30px;
            border: 1px solid #e5e7eb;
            background: #f8fafc;
            font-weight: 600;
            color: #64748b;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .cat-btn.all-btn {
            background: var(--dark);
            color: white;
            border-color: var(--dark);
        }

        .cat-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* SUB CATEGORIES */
        .sub-cats {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed #e5e7eb;
        }

        .sub-btn {
            padding: 6px 14px;
            border-radius: 15px;
            background: #f1f5f9;
            font-size: 0.85rem;
            border: none;
            cursor: pointer;
            color: #475569;
        }

        .sub-btn.active {
            background: var(--text);
            color: white;
        }

        /* GRID */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        /* CARD */
        .card {
            background: var(--white);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            cursor: pointer;
            position: relative;
        }

        .slider-wrapper {
            position: relative;
            height: 200px;
            width: 100%;
            overflow: hidden;
        }

        .card-slider {
            display: flex;
            height: 100%;
            width: 100%;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            scrollbar-width: none;
        }

        .card-slider::-webkit-scrollbar {
            display: none;
        }

        .card-img {
            min-width: 100%;
            height: 100%;
            object-fit: cover;
            scroll-snap-align: start;
        }

        .card-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 4px 10px;
            border-radius: 5px;
            font-size: 0.75rem;
            font-weight: bold;
        }

        .swipe-hint {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.7rem;
            pointer-events: none;
        }

        .card-body {
            padding: 15px;
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .card-desc {
            font-size: 0.9rem;
            color: #64748b;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            line-clamp: 2;
        }

        /* DETAIL PAGE */
        #detail-view {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--white);
            z-index: 100;
            overflow-y: auto;
        }

        .dt-header {
            position: sticky;
            top: 0;
            background: var(--white);
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 10;
        }

        .back-btn {
            font-size: 1.5rem;
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text);
        }

        .dt-title-head {
            font-size: 1.1rem;
            font-weight: 700;
            flex: 1;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }

        .dt-content {
            padding: 0 0 50px 0;
        }

        .dt-slider-box {
            width: 100%;
            height: 320px;
            background: #000;
            position: relative;
            overflow: hidden;
        }

        .dt-slider-box .card-slider {
            display: flex;
            flex-wrap: wrap;
            height: 100%;
            width: 100%;
            overflow: hidden;
            scroll-snap-type: both mandatory;
            scrollbar-width: none;
        }

        .dt-slider-box .card-slider::-webkit-scrollbar {
            display: none;
        }

        .dt-slider-box img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            scroll-snap-align: start;
            flex-shrink: 0;
        }

        .dt-arrow-btn {
            position: absolute;
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.3);
            color: white;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            transition: background 0.2s;
        }

        .dt-arrow-btn:hover {
            background: rgba(255, 255, 255, 0.6);
        }

        .dt-arrow-left {
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
        }

        .dt-arrow-right {
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
        }

        .dt-arrow-up {
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
        }

        .dt-arrow-down {
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
        }

        .dt-swipe-hint {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 12px;
            border-radius: 10px;
            font-size: 0.9rem;
            pointer-events: none;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
            z-index: 5;
        }

        .dt-info {
            padding: 20px;
        }

        .dt-name {
            font-size: 1.8rem;
            font-weight: 800;
            margin-bottom: 5px;
            line-height: 1.2;
        }

        .dt-meta {
            color: var(--primary);
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .dt-desc {
            font-size: 1rem;
            line-height: 1.6;
            color: #4b5563;
            margin-bottom: 25px;
        }

        /* SOCIAL BUTTONS GRID */
        .social-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 30px;
        }

        .soc-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 12px;
            border-radius: 10px;
            text-decoration: none;
            font-weight: 700;
            color: white;
            transition: transform 0.2s;
        }

        .soc-btn:active {
            transform: scale(0.95);
        }

        .btn-call {
            background: #333;
        }

        .btn-wa {
            background: #25D366;
        }

        .btn-insta {
            background: radial-gradient(circle at 30% 107%, #fdf497 0%, #fdf497 5%, #fd5949 45%, #d6249f 60%, #285AEB 90%);
        }

        .btn-fb {
            background: #1877F2;
        }

        .btn-web {
            background: var(--primary);
            grid-column: span 2;
        }

        .btn-like {
            background: #ef4444 !important;
            grid-column: span 2;
        }

        .related-box {
            background: #f8fafc;
            padding: 20px;
            margin-top: 20px;
            border-radius: 15px;
        }

        .related-head {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 15px;
        }

        /* LOADING INDICATOR */
        .loading-indicator {
            display: none;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 40px 20px;
            text-align: center;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #e5e7eb;
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .loading-text {
            margin-top: 15px;
            color: var(--text);
            font-weight: 500;
            font-size: 1rem;
        }

        /* Mobile tweaks: make social buttons (eg. Instagram) more prominent on small screens */
        @media (max-width: 600px) {
            .soc-btn {
                font-size: 1.1rem;
                padding: 10px;
            }

            .soc-btn i {
                font-size: 1.1rem;
            }

            /* Slightly larger card titles on small devices for readability */
            .card-title {
                font-size: 1.05rem;
            }
        }

        /* Enhanced Mobile Responsiveness */
        @media (max-width: 768px) {
            .container {
                padding: 0 10px;
            }

            .grid {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
                gap: 15px;
            }

            .controls {
                margin: -60px auto 15px auto;
                padding: 15px;
            }

            .main-cats {
                gap: 8px;
            }

            .cat-btn {
                padding: 8px 15px;
                font-size: 0.9rem;
            }

            .sub-btn {
                padding: 5px 12px;
                font-size: 0.8rem;
            }

            .card {
                border-radius: 12px;
            }

            .card-slider {
                height: 180px;
            }

            .card-body {
                padding: 12px;
            }

            .card-title {
                font-size: 1.1rem;
            }

            .dt-name {
                font-size: 1.5rem;
            }

            .dt-meta {
                font-size: 0.85rem;
            }

            .dt-desc {
                font-size: 0.95rem;
            }

            .social-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .btn-web {
                grid-column: span 1;
            }

            .theme-toggle {
                top: 10px;
                right: 10px;
                padding: 6px 10px;
                font-size: 1rem;
            }
        }

        @media (max-width: 480px) {
            .grid {
                grid-template-columns: 1fr;
            }

            .main-cats {
                flex-direction: column;
                align-items: flex-start;
            }

            .cat-btn {
                width: 100%;
                justify-content: flex-start;
            }

            .sub-cats {
                flex-wrap: wrap;
            }

            .sub-btn {
                padding: 4px 10px;
                font-size: 0.75rem;
            }

            .card-slider {
                height: 160px;
            }

            .card-title {
                font-size: 1rem;
            }

            .card-desc {
                font-size: 0.85rem;
            }

            .dt-name {
                font-size: 1.3rem;
            }

            .dt-desc {
                font-size: 0.9rem;
            }

            .dt-slider-box {
                height: 250px;
            }

            .soc-btn {
                padding: 8px;
                font-size: 1rem;
            }
        }

        /* Touch-friendly adjustments */
        @media (hover: none) and (pointer: coarse) {
            .card {
                transition: transform 0.2s;
            }

            .card:active {
                transform: scale(0.98);
            }

            .cat-btn,
            .sub-btn,
            .soc-btn {
                padding: 12px 16px;
                min-height: 44px;
                /* Minimum touch target size */
            }
        }

        /* --- SPIN & WIN CSS --- */
        .spin-trigger-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #ff4d4d, #ffcc00);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(255, 77, 77, 0.4);
            z-index: 99;
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .spin-trigger-btn:hover {
            transform: scale(1.1) rotate(15deg);
        }

        #spin-win-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            z-index: 1000;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #f8fafc;
            font-family: 'Outfit', sans-serif;
            overflow: hidden;
        }

        #spin-win-modal.show {
            display: flex;
        }

        .sw-container {
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .sw-title {
            font-size: 2.5rem;
            margin-bottom: 2rem;
            background: linear-gradient(to right, #ff4d4d, #ffcc00);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-transform: uppercase;
            letter-spacing: 4px;
            font-weight: 800;
        }

        .sw-wheel-wrapper {
            position: relative;
            width: 400px;
            height: 400px;
            margin: 0 auto 2rem;
        }

        .sw-pointer {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 50px;
            background: #f8fafc;
            clip-path: polygon(50% 100%, 0 0, 100% 0);
            z-index: 10;
        }

        .sw-wheel {
            width: 380px;
            height: 380px;
            margin: 0 auto 2.5rem;
            border-radius: 50%;
            border: 10px solid #1e293b;
            background: #0f172a;
            box-shadow: 0 0 100px rgba(251, 191, 36, 0.2),
                0 25px 50px -12px rgba(0, 0, 0, 0.8);
            padding: 10px;
        }

        /* --- ULTIMATE LUXURY SPIN & WIN (REWRITTEN) --- */
        #spin-win-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(4, 9, 20, 0.98);
            backdrop-filter: blur(20px);
            z-index: 2000;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-family: 'Outfit', sans-serif;
            overflow: hidden;
            animation: sw-modal-pop 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes sw-modal-pop {
            0% {
                opacity: 0;
                transform: scale(0.9);
            }

            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        #spin-win-modal.show {
            display: flex;
        }

        .sw-container {
            text-align: center;
            position: relative;
            z-index: 10;
            width: 100%;
            max-width: 450px;
        }

        .sw-title {
            font-size: 2.8rem;
            margin-bottom: 2rem;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 3px;
            background: linear-gradient(to bottom, #fff 0%, #fbbf24 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .sw-wheel-wrapper {
            position: relative;
            width: 380px;
            height: 380px;
            margin: 0 auto 2rem;
            border-radius: 50%;
            padding: 10px;
            background: #1e293b;
            box-shadow: 0 0 50px rgba(251, 191, 36, 0.2), 0 20px 40px rgba(0, 0, 0, 0.5);
            border: 8px solid #334155;
        }

        /* LED Lights */
        .sw-led-rim {
            position: absolute;
            top: 2px;
            left: 2px;
            right: 2px;
            bottom: 2px;
            border-radius: 50%;
            pointer-events: none;
            z-index: 5;
        }

        .sw-led {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #fff;
            border-radius: 50%;
            top: 5px;
            left: 50%;
            transform-origin: 50% 173px;
            box-shadow: 0 0 10px #fff;
            animation: sw-led-flicker 1s var(--delay) infinite alternate;
        }

        @keyframes sw-led-flicker {
            0% {
                opacity: 0.4;
                transform: scale(0.8);
            }

            100% {
                opacity: 1;
                transform: scale(1.1);
                box-shadow: 0 0 15px #fbbf24;
            }
        }

        .sw-pointer {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 45px;
            height: 60px;
            background: #f8fafc;
            clip-path: polygon(50% 100%, 0 0, 100% 0);
            z-index: 30;
            filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.5));
            transition: transform 0.1s;
        }

        .sw-pointer.ticking {
            transform: translateX(-50%) rotate(-15deg);
        }

        .sw-wheel-canvas {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: relative;
            overflow: hidden;
            transition: transform 6s cubic-bezier(0.15, 0, 0, 1);
            border: 5px solid #0f172a;
        }

        .sw-segment {
            position: absolute;
            width: 50%;
            height: 50%;
            transform-origin: 100% 100%;
            left: 0;
            top: 0;
            background: var(--bg);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .sw-segment:nth-child(1) {
            --bg: #ef4444;
            transform: rotate(0deg);
        }

        .sw-segment:nth-child(2) {
            --bg: #3b82f6;
            transform: rotate(90deg);
        }

        .sw-segment:nth-child(3) {
            --bg: #f59e0b;
            transform: rotate(180deg);
        }

        .sw-segment:nth-child(4) {
            --bg: #10b981;
            transform: rotate(270deg);
        }

        .sw-labels {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 20;
        }

        .sw-label-item {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding-top: 50px;
            transform: rotate(calc(var(--idx) * 90deg + 45deg));
            pointer-events: none;
        }

        .sw-label-item span {
            font-weight: 900;
            color: #fff;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.8);
            font-size: 0.8rem;
            text-align: center;
            max-width: 80px;
            line-height: 1.2;
            text-transform: uppercase;
        }

        .sw-hub {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50px;
            height: 50px;
            background: radial-gradient(circle at 30% 30%, #475569, #0f172a);
            border: 4px solid #1e293b;
            border-radius: 50%;
            z-index: 25;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }

        /* ACTIONS */
        .sw-actions {
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
        }

        .sw-code-input {
            background: rgba(15, 23, 42, 0.7);
            border: 2px solid rgba(251, 191, 36, 0.2);
            color: #fff;
            padding: 14px 20px;
            border-radius: 12px;
            width: 250px;
            text-align: center;
            font-size: 1.1rem;
            outline: none;
            transition: 0.3s;
        }

        .sw-code-input:focus {
            border-color: #fbbf24;
            background: rgba(15, 23, 42, 0.9);
        }

        .sw-spin-btn {
            background: linear-gradient(135deg, #fbbf24, #d97706);
            color: #000;
            font-weight: 900;
            padding: 1rem 3rem;
            border: none;
            border-radius: 50px;
            font-size: 1.2rem;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 10px 20px rgba(217, 119, 6, 0.3);
            transition: all 0.3s;
        }

        .sw-spin-btn:disabled {
            background: #334155;
            color: #64748b;
            cursor: not-allowed;
            box-shadow: none;
        }

        .sw-spin-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(217, 119, 6, 0.4);
        }

        .sw-close-x {
            position: absolute;
            top: 25px;
            right: 25px;
            background: none;
            border: none;
            color: #fff;
            font-size: 30px;
            cursor: pointer;
            opacity: 0.6;
            transition: 0.3s;
        }

        .sw-close-x:hover {
            opacity: 1;
            transform: rotate(90deg);
        }

        /* WIN POPUP */
        .sw-result-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2500;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
        }

        .sw-result-overlay.active {
            display: flex;
            animation: sw-fade-in 0.3s;
        }

        @keyframes sw-fade-in {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .sw-result-card {
            background: #1e293b;
            padding: 40px;
            border-radius: 24px;
            border: 2px solid #fbbf24;
            max-width: 400px;
            width: 90%;
            transform: scale(0.8);
            animation: sw-card-pop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        @keyframes sw-card-pop {
            to {
                transform: scale(1);
            }
        }

        .sw-res-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .sw-res-title {
            font-size: 2rem;
            color: #fbbf24;
            margin-bottom: 15px;
            font-weight: 900;
        }

        .sw-res-text {
            font-size: 1.2rem;
            color: #f8fafc;
            margin-bottom: 30px;
        }

        /* LOAD MORE BUTTON */
        .load-more-container {
            display: flex;
            justify-content: center;
            width: 100%;
            padding: 20px 0 40px 0;
        }

        .load-more-btn {
            background: linear-gradient(135deg, var(--primary), #1d4ed8);
            color: white;
            border: none;
            padding: 12px 35px;
            font-size: 1rem;
            font-weight: 700;
            border-radius: 30px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: none;
            /* Hidden by default until JS runs */
        }

        .load-more-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 25px rgba(37, 99, 235, 0.5);
        }

        .load-more-btn:active {
            transform: scale(0.95);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body>

    <div id="home-view">
        <header>
            <button class="theme-toggle" onclick="toggleTheme()" title="Toggle dark/light mode"><i
                    class="fas fa-moon"></i></button>
            <div class="banner-slider" id="bannerSlider">
                <div class="banner-slide active">
                    <div class="banner-text">KhurjaX</div>
                </div>
                <div class="banner-slide">
                    <div class="banner-text">KhurjaX</div>
                </div>
                <div class="banner-slide">
                    <div class="banner-text">KhurjaX</div>
                </div>
                <div class="banner-indicators" id="bannerIndicators">
                    <div class="banner-indicator active" onclick="currentBanner(0)"></div>
                    <div class="banner-indicator" onclick="currentBanner(1)"></div>
                    <div class="banner-indicator" onclick="currentBanner(2)"></div>
                </div>
            </div>
        </header>

        <div class="controls">
            <div style="display: flex; align-items: center; gap: 10px;">
                <input type="text" id="searchInput" class="search-box" placeholder="Search Shop, Job, Place..."
                    onkeyup="globalSearch()">
                <img src="https://i.ibb.co/Rkdm6570/Chat-GPT-Image-Dec-25-2025-11-41-40-PM.png" alt="Khurja X Logo"
                    style="width: 50px; height: 50px; border-radius: 50%;">
            </div>

            <div class="main-cats">
                <button class="cat-btn all-btn active" onclick="setCategory('All')"><i class="fas fa-th-large"></i>
                    Home</button>
                <button class="cat-btn" onclick="setCategory('More')"><i class="fas fa-ellipsis-h"></i> More âž•</button>
            </div>

            <div class="sub-cats" id="subCatContainer"><small>Showing All Listings</small></div>
        </div>

        <div class="container">
            <div class="grid" id="mainGrid">


                <!-- Loading Indicator -->
                <div class="loading-indicator" id="loadingIndicator">
                    <div class="loading-spinner"></div>
                    <div class="loading-text">Loading content...</div>
                </div>



                <div id="card-abhinav" class="card" onclick="openDetail(this)" data-main="Gaming" data-sub="BGMI"
                    data-pin="on" data-title="ABHINAV YADAV" data-desc="GAME ID 55613751771, GAME NAME A7ALLGAME"
                    data-phone="9876543210" data-whatsapp="9876543210" data-insta="https://instagram.com" data-fb=""
                    data-website="">
                    <div class="slider-wrapper">
                        <span class="card-badge" style="background:#333;">BGMI</span>
                        <div class="card-slider"><img src="https://i.ibb.co/B2TgMmHT/4.jpg" class="card-img"><img
                                src="https://i.ibb.co/bg31vk89/5.jpg" class="card-img"><img
                                src="https://i.ibb.co/vCKbj9pb/6.jpg" class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">ABHINAV YADAV</h3>
                        <p class="card-desc">GAME ID 55613751771, GAME NAME A7ALLGAME</p>
                    </div>
                </div>


                <div id="card-1" class="card" onclick="openDetail(this)" data-main="Services" data-sub="Makeup"
                    data-pin="on" data-title="Glamour Beauty Parlour"
                    data-desc="Bridal Makeup, Party Makeup, Hair Spa, Facial, Mehendi. Ladies Only."
                    data-phone="9876543210" data-whatsapp="9876543210" data-insta="https://instagram.com" data-fb=""
                    data-website="">
                    <div class="slider-wrapper">
                        <span class="card-badge" style="background:#db2777;">Makeup</span>
                        <div class="card-slider"><img
                                src="https://images.unsplash.com/photo-1560750588-73207b1ef5b8?w=600"
                                class="card-img"><img
                                src="https://images.unsplash.com/photo-1522337660859-02fbefca4702?w=600"
                                class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Glamour Beauty Parlour</h3>
                        <p class="card-desc">Bridal Makeup & Spa.</p>
                    </div>
                </div>

                <div id="card-2" class="card" onclick="openDetail(this)" data-main="Education" data-sub="Schools"
                    data-pin="" data-title="Khurja Public School"
                    data-desc="CBSE Board School. Nursery to 12th. Smart Classes & Transport." data-phone="9876543210"
                    data-whatsapp="9876543210" data-insta="" data-fb="https://facebook.com"
                    data-website="https://kps.com">
                    <div class="slider-wrapper">
                        <span class="card-badge">School</span>
                        <div class="card-slider"><img
                                src="https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=600"
                                class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Khurja Public School</h3>
                        <p class="card-desc">CBSE Board, Nursery to 12th.</p>
                    </div>
                </div>

                <div id="card-3" class="card" onclick="openDetail(this)" data-main="Food" data-sub="Restaurant"
                    data-pin="" data-title="The Spicy Bite"
                    data-desc="Family AC Restaurant serving Chinese, Pizza, Burger & North Indian."
                    data-phone="9876543210" data-whatsapp="9876543210" data-insta="https://instagram.com" data-fb=""
                    data-website="">
                    <div class="slider-wrapper">
                        <span class="card-badge" style="background:#f59e0b;">Restaurant</span>
                        <div class="card-slider"><img
                                src="https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=600"
                                class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">The Spicy Bite</h3>
                        <p class="card-desc">Family AC Restaurant.</p>
                    </div>
                </div>

                <div id="card-4" class="card" onclick="openDetail(this)" data-main="Services" data-sub="Electrician"
                    data-pin="" data-title="Raju Electrician"
                    data-desc="24/7 Home Service for Fan, AC, Wiring, Inverter." data-phone="9876543210"
                    data-whatsapp="9876543210" data-insta="" data-fb="" data-website="">
                    <div class="slider-wrapper">
                        <span class="card-badge" style="background:#333;">Service</span>
                        <div class="card-slider"><img
                                src="https://images.unsplash.com/photo-1621905251189-08b45d6a269e?w=600"
                                class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Raju Electrician</h3>
                        <p class="card-desc">Home Repair Service.</p>
                    </div>
                </div>

                <div id="card-5" class="card" onclick="openDetail(this)" data-main="Special" data-sub="Pottery"
                    data-pin="" data-title="Khurja Ceramic Works"
                    data-desc="Manufacturer & Exporter of Ceramic Pots, Planters, Mugs. Wholesale prices."
                    data-phone="9876543210" data-whatsapp="9876543210" data-insta="" data-fb=""
                    data-website="https://khurjaceramic.com">
                    <div class="slider-wrapper">
                        <span class="card-badge">Pottery</span>
                        <div class="card-slider"><img
                                src="https://images.unsplash.com/photo-1565193566173-7a64b27876e9?w=600"
                                class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Khurja Ceramic Works</h3>
                        <p class="card-desc">Factory Outlet.</p>
                    </div>
                </div>

                <div id="card-6" class="card" onclick="openDetail(this)" data-main="Special" data-sub="Pottery"
                    data-pin="" data-title="Khurja Ceramic Works" data-desc="Wholesale Ceramic Items."
                    data-phone="9876543210" data-whatsapp="9876543210" data-insta="" data-fb="" data-website="">
                    <div class="slider-wrapper">
                        <span class="card-badge">Pottery</span>
                        <div class="card-slider"><img
                                src="https://images.unsplash.com/photo-1565193566173-7a64b27876e9?w=600"
                                class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Khurja Ceramic Works</h3>
                        <p class="card-desc">Wholesale Ceramic Items.</p>
                    </div>
                </div>

                <div id="card-7" class="card" onclick="openDetail(this)" data-main="Updates" data-sub="Jobs" data-pin=""
                    data-title="Salesman Required"
                    data-desc="Need Salesman for Cloth Shop in Gandhi Market. Salary 10k-15k. Full Time."
                    data-phone="9876543210" data-whatsapp="9876543210" data-insta="" data-fb="" data-website="">
                    <div class="slider-wrapper">
                        <span class="card-badge" style="background:red;">Hiring</span>
                        <div class="card-slider"><img
                                src="https://images.unsplash.com/photo-1521791136064-7986c2920216?w=600"
                                class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Salesman Required</h3>
                        <p class="card-desc">Urgent Job Vacancy.</p>
                    </div>
                </div>

                <div id="card-8" class="card" onclick="openDetail(this)" data-main="Services" data-sub="MarriageHall"
                    data-pin="" data-title="Royal Palace Banquet"
                    data-desc="Luxury AC Banquet Hall for Weddings, Parties. Big Lawn and Catering available."
                    data-phone="9876543210" data-whatsapp="9876543210" data-insta="https://instagram.com" data-fb=""
                    data-website="">
                    <div class="slider-wrapper">
                        <span class="card-badge" style="background:#8b5cf6;">Banquet</span>
                        <div class="card-slider"><img
                                src="https://images.unsplash.com/photo-1519741497674-611481863552?w=600"
                                class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Royal Palace Banquet</h3>
                        <p class="card-desc">Wedding Hall & Lawn.</p>
                    </div>
                </div>

                <div id="card-9" class="card" onclick="openDetail(this)" data-main="Services" data-sub="Transport"
                    data-pin="" data-title="Sonu E-Rickshaw"
                    data-desc="Available for City Ride, Railway Station drop, Market visit. Call for booking."
                    data-phone="9876543210" data-whatsapp="9876543210" data-insta="" data-fb="" data-website="">
                    <div class="slider-wrapper">
                        <span class="card-badge" style="background:#333;">Transport</span>
                        <div class="card-slider"><img
                                src="https://images.unsplash.com/photo-1596525996025-a134a6259468?w=600"
                                class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Sonu E-Rickshaw</h3>
                        <p class="card-desc">Call for City Ride.</p>
                    </div>
                </div>

                <div id="card-10" class="card" onclick="openDetail(this)" data-main="Health" data-sub="Gym" data-pin=""
                    data-title="Iron Fitness Gym"
                    data-desc="Cardio, Weight Training, Personal Trainer. Ladies Batch Available."
                    data-phone="9876543210" data-whatsapp="9876543210" data-insta="https://instagram.com" data-fb=""
                    data-website="">
                    <div class="slider-wrapper">
                        <span class="card-badge" style="background:#10b981;">Gym</span>
                        <div class="card-slider"><img
                                src="https://images.unsplash.com/photo-1534438327276-14e5300c3a48?w=600"
                                class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Iron Fitness Gym</h3>
                        <p class="card-desc">Unisex Gym & Cardio.</p>
                    </div>
                </div>

                <div id="card-11" class="card" onclick="openDetail(this)" data-main="Property" data-sub="RentHouse"
                    data-pin="" data-title="2 BHK House for Rent"
                    data-desc="Semi-furnished house near Bus Stand. 2 Rooms, Kitchen, Bathroom. Rent 6000."
                    data-phone="9876543210" data-whatsapp="9876543210" data-insta="" data-fb="" data-website="">
                    <div class="slider-wrapper">
                        <span class="card-badge" style="background:#10b981;">To Let</span>
                        <div class="card-slider"><img
                                src="https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=600" class="card-img">
                        </div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">2 BHK House</h3>
                        <p class="card-desc">Rent: â‚¹6000/month.</p>
                    </div>
                </div>















                <!-- JOBS & CAREERS -->
                <div class="card" onclick="openDetail(this)" data-main="Market" data-sub="Jobs" data-pin=""
                    data-title="Factory Worker"
                    data-desc="Pottery factory worker position. Experience preferred. Salary â‚¹12,000 - â‚¹15,000/month."
                    data-phone="9876543210" data-whatsapp="9876543210" data-insta="" data-fb="" data-website="">
                    <div class="slider-wrapper"><span class="card-badge" style="background:#333;">Factory</span>
                        <div class="card-slider"><img
                                src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=600"
                                class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Factory Worker</h3>
                        <p class="card-desc">Pottery factory worker. â‚¹12,000 - â‚¹15,000/month.</p>
                    </div>
                </div>

                <div class="card" onclick="openDetail(this)" data-main="Market" data-sub="Jobs" data-pin=""
                    data-title="Accountant"
                    data-desc="ABC Trading Company looking for accountant. Experience required. Salary â‚¹18,000 - â‚¹25,000/month."
                    data-phone="9876543210" data-whatsapp="9876543210" data-insta="" data-fb="" data-website="">
                    <div class="slider-wrapper"><span class="card-badge" style="background:#10b981;">Office</span>
                        <div class="card-slider"><img
                                src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?w=600"
                                class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Accountant</h3>
                        <p class="card-desc">ABC Trading Company. â‚¹18,000 - â‚¹25,000/month.</p>
                    </div>
                </div>

                <div class="card" onclick="openDetail(this)" data-main="Services" data-sub="Jobs" data-pin=""
                    data-title="Delivery Boy"
                    data-desc="Local Kirana Store hiring delivery boy. Own vehicle required. Salary â‚¹8,000 - â‚¹10,000/month."
                    data-phone="9876543210" data-whatsapp="9876543210" data-insta="" data-fb="" data-website="">
                    <div class="slider-wrapper"><span class="card-badge" style="background:#f59e0b;">Delivery</span>
                        <div class="card-slider"><img
                                src="https://images.unsplash.com/photo-1596525912800-158092104704?w=600"
                                class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Delivery Boy</h3>
                        <p class="card-desc">Local Kirana Store. â‚¹8,000 - â‚¹10,000/month.</p>
                    </div>
                </div>

                <div class="card" onclick="openDetail(this)" data-main="Services" data-sub="Jobs" data-pin=""
                    data-title="General Helper"
                    data-desc="Hardware Store looking for general helper. Flexible hours. Salary â‚¹9,000 - â‚¹12,000/month."
                    data-phone="9876543210" data-whatsapp="9876543210" data-insta="" data-fb="" data-website="">
                    <div class="slider-wrapper"><span class="card-badge" style="background:#333;">Helper</span>
                        <div class="card-slider"><img
                                src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=600"
                                class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">General Helper</h3>
                        <p class="card-desc">Hardware Store. â‚¹9,000 - â‚¹12,000/month.</p>
                    </div>
                </div>

                <div class="card" onclick="openDetail(this)" data-main="Services" data-sub="Jobs" data-pin=""
                    data-title="Marketing Executive"
                    data-desc="Local Business Group hiring marketing executive. Experience preferred. Salary â‚¹15,000 - â‚¹20,000/month."
                    data-phone="9876543210" data-whatsapp="9876543210" data-insta="" data-fb="" data-website="">
                    <div class="slider-wrapper"><span class="card-badge" style="background:#10b981;">Marketing</span>
                        <div class="card-slider"><img
                                src="https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=600" class="card-img">
                        </div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Marketing Executive</h3>
                        <p class="card-desc">Local Business Group. â‚¹15,000 - â‚¹20,000/month.</p>
                    </div>
                </div>

                <div class="card" onclick="openDetail(this)" data-main="Services" data-sub="Jobs" data-pin=""
                    data-title="Freelance Designer"
                    data-desc="Creative Solutions looking for freelance designer. Project basis. â‚¹500 - â‚¹1000 per project."
                    data-phone="9876543210" data-whatsapp="9876543210" data-insta="" data-fb="" data-website="">
                    <div class="slider-wrapper"><span class="card-badge" style="background:#db2777;">Freelance</span>
                        <div class="card-slider"><img
                                src="https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=600" class="card-img">
                        </div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Freelance Designer</h3>
                        <p class="card-desc">Creative Solutions. â‚¹500 - â‚¹1000 per project.</p>
                    </div>
                </div>

                <!-- HEALTH & FITNESS -->
                <div class="card" onclick="openDetail(this)" data-main="Health" data-sub="Hospitals" data-pin=""
                    data-title="Khurja District Hospital"
                    data-desc="Government hospital providing general and specialized medical care."
                    data-phone="9876543210" data-whatsapp="" data-insta="" data-fb="" data-website="">
                    <div class="slider-wrapper"><span class="card-badge" style="background:#10b981;">Hospital</span>
                        <div class="card-slider"><img
                                src="https://i.pinimg.com/736x/2b/92/e3/2b92e3453f4e10412e7af0ba6d649adc.jpg"
                                class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Khurja District Hospital</h3>
                        <p class="card-desc">Government hospital providing general and specialized medical care.</p>
                    </div>
                </div>

                <div class="card" onclick="openDetail(this)" data-main="Health" data-sub="Clinics" data-pin=""
                    data-title="MediCare Clinic"
                    data-desc="Multi-specialty clinic with experienced doctors and diagnostic services."
                    data-phone="9876543210" data-whatsapp="9876543210" data-insta="" data-fb="" data-website="">
                    <div class="slider-wrapper"><span class="card-badge" style="background:#10b981;">Clinic</span>
                        <div class="card-slider"><img
                                src="https://i.pinimg.com/736x/2b/92/e3/2b92e3453f4e10412e7af0ba6d649adc.jpg"
                                class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">MediCare Clinic</h3>
                        <p class="card-desc">Multi-specialty clinic with experienced doctors and diagnostic services.
                        </p>
                    </div>
                </div>

                <div class="card" onclick="openDetail(this)" data-main="Health" data-sub="Gym" data-pin=""
                    data-title="Fitness 52"
                    data-desc="Weight Training, Cardio, Personal Training, Zumba / Yoga. Trainer Available."
                    data-phone="08971400663" data-whatsapp="" data-insta="" data-fb="" data-website="">
                    <div class="slider-wrapper"><span class="card-badge" style="background:#10b981;">Gym</span>
                        <div class="card-slider"><img
                                src="https://i.pinimg.com/736x/2b/92/e3/2b92e3453f4e10412e7af0ba6d649adc.jpg"
                                class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Fitness 52</h3>
                        <p class="card-desc">Fit raho, strong bano daily! â€¢ Yamunapuram</p>
                    </div>
                </div>

                <div class="card" onclick="openDetail(this)" data-main="Health" data-sub="Gym" data-pin=""
                    data-title="ICONIQ Gym"
                    data-desc="Weight Training, Cardio, Personal Training, Zumba / Yoga. Modern gym."
                    data-phone="09008403170" data-whatsapp="" data-insta="" data-fb="" data-website="">
                    <div class="slider-wrapper"><span class="card-badge" style="background:#10b981;">Gym</span>
                        <div class="card-slider"><img
                                src="https://i.pinimg.com/736x/2b/92/e3/2b92e3453f4e10412e7af0ba6d649adc.jpg"
                                class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">ICONIQ Gym</h3>
                        <p class="card-desc">Modern gym, top results! â€¢ DM Colony</p>
                    </div>
                </div>

                <div class="card" onclick="openDetail(this)" data-main="Health" data-sub="Gym" data-pin=""
                    data-title="The Royal Gym" data-desc="Weight Training, Cardio, Personal Training, Zumba / Yoga."
                    data-phone="" data-whatsapp="" data-insta="" data-fb="" data-website="">
                    <div class="slider-wrapper"><span class="card-badge" style="background:#10b981;">Gym</span>
                        <div class="card-slider"><img
                                src="https://i.pinimg.com/736x/2b/92/e3/2b92e3453f4e10412e7af0ba6d649adc.jpg"
                                class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">The Royal Gym</h3>
                        <p class="card-desc">Royal fitness, royal body! â€¢ Balmiki Chowk</p>
                    </div>
                </div>

                <div class="card" onclick="openDetail(this)" data-main="Health" data-sub="Gym" data-pin=""
                    data-title="Fit X Gym" data-desc="Weight Training, Cardio, Personal Training, Zumba / Yoga."
                    data-phone="" data-whatsapp="" data-insta="" data-fb="" data-website="">
                    <div class="slider-wrapper"><span class="card-badge" style="background:#10b981;">Gym</span>
                        <div class="card-slider"><img
                                src="https://i.pinimg.com/736x/2b/92/e3/2b92e3453f4e10412e7af0ba6d649adc.jpg"
                                class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Fit X Gym</h3>
                        <p class="card-desc">Fit body, X-tra power! â€¢ GT Road</p>
                    </div>
                </div>

                <div class="card" onclick="openDetail(this)" data-main="Health" data-sub="Pharmacy" data-pin=""
                    data-title="Sunrise Pharmacy"
                    data-desc="Pharmacy providing prescription medicines and general medical items."
                    data-phone="09897139397" data-whatsapp="" data-insta="" data-fb="" data-website="">
                    <div class="slider-wrapper"><span class="card-badge" style="background:#10b981;">Pharmacy</span>
                        <div class="card-slider"><img
                                src="https://i.pinimg.com/736x/2b/92/e3/2b92e3453f4e10412e7af0ba6d649adc.jpg"
                                class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Sunrise Pharmacy</h3>
                        <p class="card-desc">Medical Store â€¢ GT Road, Khurja</p>
                    </div>
                </div>

                <div class="card" onclick="openDetail(this)" data-main="Health" data-sub="Pharmacy" data-pin=""
                    data-title="New Singhal Medical Store"
                    data-desc="Medical store with medicines and healthcare products." data-phone="09045190250"
                    data-whatsapp="" data-insta="" data-fb="" data-website="">
                    <div class="slider-wrapper"><span class="card-badge" style="background:#10b981;">Pharmacy</span>
                        <div class="card-slider"><img
                                src="https://i.pinimg.com/736x/2b/92/e3/2b92e3453f4e10412e7af0ba6d649adc.jpg"
                                class="card-img"></div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">New Singhal Medical Store</h3>
                        <p class="card-desc">Medical Store â€¢ Jewar Adda Chauraha</p>
                    </div>
                </div>

            </div>

            <!-- Load More Button -->
            <div id="loadMoreContainer" class="load-more-container">
                <button id="loadMoreBtn" class="load-more-btn" onclick="loadMore()">Load More</button>
            </div>
        </div>
    </div>

    <div id="detail-view">
        <div class="dt-header">
            <button class="back-btn" onclick="closeDetail()"><i class="fas fa-arrow-left"></i></button>
            <div class="dt-title-head" id="dt-head-title">Title</div>
        </div>

        <div class="dt-content">
            <div class="dt-slider-box" id="dt-slider-container">
                <button class="dt-arrow-btn dt-arrow-left" onclick="moveDetailImage(-1)">â€¹</button>
                <button class="dt-arrow-btn dt-arrow-right" onclick="moveDetailImage(1)">â€º</button>
            </div>

            <div class="dt-info">
                <div class="dt-name" id="dt-title">Title</div>
                <div class="dt-meta" id="dt-cat">Category</div>
                <div class="dt-desc" id="dt-desc">Description</div>

                <div class="social-grid">
                    <a id="lnk-call" href="#" class="soc-btn btn-call"><i class="fas fa-phone"></i> Call</a>
                    <a id="lnk-wa" href="#" class="soc-btn btn-wa"><i class="fab fa-whatsapp"></i> WhatsApp</a>
                    <a id="lnk-insta" href="#" class="soc-btn btn-insta"><i class="fab fa-instagram"></i> Instagram</a>
                    <a id="lnk-fb" href="#" class="soc-btn btn-fb"><i class="fab fa-facebook-f"></i> Facebook</a>
                    <a id="lnk-web" href="#" class="soc-btn btn-web"><i class="fas fa-globe"></i> Visit Website</a>
                    <button id="lnk-like" class="soc-btn btn-like" onclick="toggleDetailLike(event)"><i
                            class="fas fa-heart"></i> <span id="like-text">Like</span></button>
                </div>

                <div class="related-box">
                    <div class="related-head">Explore More</div>
                    <div class="grid" id="related-grid"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // DATA CATEGORIES
        const subCategories = {
            'More': ['All Categories', 'Market', 'Food', 'Services', 'Health', 'Education', 'Property', 'Special', 'Travel', 'Khurja Special', 'Content Creators', 'Gaming', 'Events', 'Emergency', 'Religion'],
            'Trending': ['This Week', 'All Time'],
            'Market': ['Kirana', 'MobileShop', 'Clothes', 'Jewellery', 'Medical store', 'Gift store'],
            'Food': ['Restaurant', 'Bakery', 'Fast Food'],
            'Services': ['Makeup', 'Barber/Hair salon', 'Electrician', 'Plumber', 'ACRepair'],
            'Health': ['Hospitals', 'Clinics', 'Gym', 'Pharmacy', 'Government Hospital', 'Private Hospital'],
            'Education': ['Schools', 'Colleges', 'Coaching', 'Play School', 'Library', 'Computer Institute'],
            'Property': ['RentHouse', 'BuySell', 'Plots', 'Rent House', 'Buy/Sell'],
            'Special': ['Pottery', 'Handicrafts', 'Ceramic Factories', 'Ceramic Wholesale'],
            'Travel': ['Hotels', 'Restaurants', 'E-Rickshaw'],
            'Khurja Special': ['Pottery', 'Ceramic Factories', 'Ceramic Wholesale'],
            'Content Creators': ['YouTubers', 'Instagram Influencers'],
            'Gaming': ['BGMI', 'FREE FIRE'],
            'Events': ['Local News', 'Festivals', 'New Openings'],
            'Emergency & Help': ['Police', 'Fire Station', 'Blood Donors'],
            'Religion & Places': ['Hindu Temple', 'Islamic Mosque', 'Christian Church', 'Other']
        };

        // PAGINATION CONFIG
        const ITEMS_PER_PAGE = 12;
        let currentPage = 1;

        // Initialize Pagination
        function renderPagination() {
            const cards = Array.from(document.querySelectorAll('.card'));

            // Filter eligible cards (those that match current search/filter)
            // If data-visible-filter is missing, assume it matches (initial state)
            const visibleCards = cards.filter(card => {
                const attr = card.getAttribute('data-visible-filter');
                return attr === null || attr === 'true';
            });

            // Calculate range to show
            const showLimit = currentPage * ITEMS_PER_PAGE;

            // Apply visibility
            visibleCards.forEach((card, index) => {
                if (index < showLimit) {
                    card.style.display = 'block';
                    // Animation for new items
                    if (index >= (currentPage - 1) * ITEMS_PER_PAGE && currentPage > 1) {
                        card.style.animation = 'fadeInUp 0.5s ease backwards';
                    }
                } else {
                    card.style.display = 'none';
                }
            });

            // Hide cards that don't match filter
            cards.forEach(card => {
                const attr = card.getAttribute('data-visible-filter');
                if (attr === 'false') {
                    card.style.display = 'none';
                }
            });

            // Manage Button Visibility
            const btn = document.getElementById('loadMoreBtn');
            if (visibleCards.length > showLimit) {
                btn.style.display = 'block';
                btn.innerText = `Load More (${visibleCards.length - showLimit} remaining)`;
            } else {
                btn.style.display = 'none';
            }
        }

        function loadMore() {
            currentPage++;
            renderPagination();
        }

        // Initialize on load to handle static content
        document.addEventListener('DOMContentLoaded', () => {
            // Delay slightly to ensure elements are parsed
            setTimeout(renderPagination, 50);
        });

        // CATEGORY FILTER
        function setCategory(mainCat) {
            // Show loading indicator
            document.getElementById('loadingIndicator').style.display = 'flex';

            // Clear previous active state
            document.querySelectorAll('.cat-btn').forEach(btn => btn.classList.remove('active'));
            // Try to set active button robustly (don't rely on global `event` which may be undefined)
            const btns = Array.from(document.querySelectorAll('.cat-btn'));
            const matchedBtn = btns.find(b => b.textContent.trim().toLowerCase().includes(mainCat.toLowerCase()));
            if (matchedBtn) matchedBtn.classList.add('active');
            const subContainer = document.getElementById('subCatContainer');
            subContainer.innerHTML = '';

            if (mainCat === 'All') {
                subContainer.innerHTML = '<small>Showing All Listings</small>';
                filterGrid('All', 'All');
            } else if (mainCat === 'More') {
                subContainer.innerHTML = '<button class="sub-btn active" onclick="setCategory(\'All\')">All Categories</button>';
                subCategories['More'].forEach(sub => {
                    if (sub !== 'All Categories') {
                        subContainer.innerHTML += `<button class="sub-btn" onclick="setCategory('${sub}')">${sub}</button>`;
                    }
                });
                filterGrid('More', 'All');
            } else {
                if (subCategories[mainCat]) {
                    subContainer.innerHTML += `<button class="sub-btn active" onclick="filterGrid('${mainCat}', 'All')">All</button>`;
                    subCategories[mainCat].forEach(sub => {
                        subContainer.innerHTML += `<button class="sub-btn" onclick="filterGrid('${mainCat}', '${sub}')">${sub}</button>`;
                    });
                }
                filterGrid(mainCat, 'All');
            }
        }

        // GRID FILTER
        function filterGrid(main, sub) {
            // Manage sub-button active states without relying on global `event`.
            if (sub !== 'All') {
                document.querySelectorAll('.sub-btn').forEach(btn => btn.classList.remove('active'));
                // find a sub button whose text matches the requested sub
                const subBtns = Array.from(document.querySelectorAll('.sub-btn'));
                const matched = subBtns.find(b => b.textContent.trim().toLowerCase() === String(sub).toLowerCase());
                if (matched) matched.classList.add('active');
            }

            const cards = document.querySelectorAll('.card');
            cards.forEach(card => {
                const cMain = card.getAttribute('data-main');
                const cSub = card.getAttribute('data-sub');
                let isMatch = false;

                if (main === 'All') {
                    isMatch = true;
                } else if (main === 'More') {
                    isMatch = true;
                } else if (sub === 'All') {
                    isMatch = (cMain === main);
                } else {
                    isMatch = (cMain === main && cSub === sub);
                }

                card.setAttribute('data-visible-filter', isMatch);
            });

            // Reset to page 1
            currentPage = 1;
            renderPagination();

            // Hide loading indicator after filtering is complete
            setTimeout(() => {
                document.getElementById('loadingIndicator').style.display = 'none';
            }, 100); // Small delay to make the loading indicator visible
        }


        // SEARCH
        function globalSearch() {
            // Show loading indicator during search
            document.getElementById('loadingIndicator').style.display = 'flex';

            const input = document.getElementById('searchInput').value.toLowerCase();

            // Add delay to avoid too frequent updates during typing
            clearTimeout(window.searchTimeout);
            window.searchTimeout = setTimeout(() => {
                document.querySelectorAll('.card').forEach(card => {
                    const text = card.innerText.toLowerCase() + card.getAttribute('data-desc').toLowerCase();
                    const isMatch = text.includes(input);
                    card.setAttribute('data-visible-filter', isMatch);
                });

                currentPage = 1;
                renderPagination();

                // Hide loading indicator after search is complete
                setTimeout(() => {
                    document.getElementById('loadingIndicator').style.display = 'none';
                }, 100);
            }, 300); // 300ms delay to allow for typing
        }

        // Shuffle the main grid but keep specific items at the top
        function shuffleMainGrid() {
            const grid = document.getElementById('mainGrid');
            if (!grid) return;

            // collect only direct card elements
            const cards = Array.from(grid.querySelectorAll('.card'));
            if (cards.length <= 1) return;

            // Separate pinned and non-pinned logic based on data-pin="on"
            const pinned = [];
            const others = [];

            cards.forEach(card => {
                const pinStatus = card.getAttribute('data-pin');
                if (pinStatus === 'on') {
                    pinned.push(card);
                } else {
                    others.push(card);
                }
            });

            // Fisher-Yates shuffle for 'others' only
            for (let i = others.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                const tmp = others[i];
                others[i] = others[j];
                others[j] = tmp;
            }

            // Append in order: Pinned items first, then Shuffled others
            pinned.forEach(c => grid.appendChild(c));
            others.forEach(c => grid.appendChild(c));

            // Mark all as visible filter if not set (init)
            cards.forEach(c => {
                if (!c.hasAttribute('data-visible-filter')) c.setAttribute('data-visible-filter', 'true');
            });

            // Re-render pagination
            renderPagination();
        }

        // OPEN DETAIL PAGE
        function openDetail(card) {
            // Show loading indicator for detail view
            const detailLoadingIndicator = document.getElementById('detailLoadingIndicator');
            if (detailLoadingIndicator) {
                detailLoadingIndicator.style.display = 'flex';
            }

            const d = {
                title: card.getAttribute('data-title'),
                desc: card.getAttribute('data-desc'),
                phone: card.getAttribute('data-phone'),
                wa: card.getAttribute('data-whatsapp'),
                web: card.getAttribute('data-website'),
                insta: card.getAttribute('data-insta'),
                fb: card.getAttribute('data-fb'),
                main: card.getAttribute('data-main'),
                sub: card.getAttribute('data-sub')
            };

            // Image
            const cardImages = card.querySelector('.card-slider').innerHTML;
            const sliderContainer = document.getElementById('dt-slider-container');
            sliderContainer.innerHTML = `<div class="card-slider">${cardImages}</div><div class="dt-swipe-hint">â† Swipe â†’</div>`;
            // re-attach arrow buttons (they were cleared)
            sliderContainer.innerHTML += `
                <button class="dt-arrow-btn dt-arrow-left" onclick="moveDetailImage(-1)">â€¹</button>
                <button class="dt-arrow-btn dt-arrow-right" onclick="moveDetailImage(1)">â€º</button>
            `;

            // Text
            document.getElementById('dt-title').innerText = d.title;
            document.getElementById('dt-head-title').innerText = d.title;
            document.getElementById('dt-cat').innerText = `${d.main} > ${d.sub}`;
            document.getElementById('dt-desc').innerText = d.desc;

            // Buttons Logic
            const btnCall = document.getElementById('lnk-call');
            const btnWa = document.getElementById('lnk-wa');
            const btnInsta = document.getElementById('lnk-insta');
            const btnFb = document.getElementById('lnk-fb');
            const btnWeb = document.getElementById('lnk-web');

            btnCall.href = d.phone ? `tel:${d.phone}` : '#';
            btnWa.href = d.wa ? `https://wa.me/91${d.wa}` : '#';
            btnInsta.href = d.insta && d.insta !== 'https://instagram.com' ? d.insta : 'https://www.instagram.com/xloyalteam?igsh=MWY3OTI0b2xlazV4dA==';
            btnFb.href = d.fb ? d.fb : '#';
            btnWeb.href = d.web ? d.web : '#';

            btnCall.style.display = d.phone ? 'flex' : 'none';
            btnWa.style.display = d.wa ? 'flex' : 'none';
            btnInsta.style.display = d.insta ? 'flex' : 'none';
            btnFb.style.display = d.fb ? 'flex' : 'none';
            btnWeb.style.display = d.web ? 'flex' : 'none';

            // Update phone button text to show the actual phone number and add copy functionality
            if (d.phone) {
                btnCall.innerHTML = `<i class="fas fa-phone"></i> Call ${d.phone}`;
                btnCall.onclick = function (e) {
                    e.preventDefault();
                    navigator.clipboard.writeText(d.phone).then(() => {
                        // Show visual feedback
                        const originalText = btnCall.innerHTML;
                        btnCall.innerHTML = `<i class="fas fa-check"></i> Copied!`;
                        setTimeout(() => {
                            btnCall.innerHTML = `<i class="fas fa-phone"></i> Call ${d.phone}`;
                        }, 2000);
                    }).catch(err => {
                        console.error('Failed to copy phone number: ', err);
                    });
                };
            } else {
                btnCall.innerHTML = `<i class="fas fa-phone"></i> Call`;
            }

            // Update WhatsApp button to show the actual number and add copy functionality
            if (d.wa) {
                btnWa.innerHTML = `<i class="fab fa-whatsapp"></i> WhatsApp ${d.wa}`;
                btnWa.onclick = function (e) {
                    e.preventDefault();
                    navigator.clipboard.writeText(d.wa).then(() => {
                        // Show visual feedback
                        const originalText = btnWa.innerHTML;
                        btnWa.innerHTML = `<i class="fas fa-check"></i> Copied!`;
                        setTimeout(() => {
                            btnWa.innerHTML = `<i class="fab fa-whatsapp"></i> WhatsApp ${d.wa}`;
                        }, 2000);
                    }).catch(err => {
                        console.error('Failed to copy WhatsApp number: ', err);
                    });
                };
            } else {
                btnWa.onclick = function (e) {
                    e.preventDefault();
                    window.open(btnWa.href, '_blank');
                };
            }

            // Related: DON'T clone entire grid - only show related items by filtering
            const relatedGrid = document.getElementById('related-grid');
            relatedGrid.innerHTML = ''; // Clear first

            // Only add cards that match the same main category
            const mainGridCards = document.querySelectorAll('#mainGrid .card');
            mainGridCards.forEach(c => {
                if (c.getAttribute('data-main') === d.main) {
                    const clone = c.cloneNode(true);
                    relatedGrid.appendChild(clone);
                }
            });

            // Hide detail loading indicator
            setTimeout(() => {
                const detailLoadingIndicator = document.getElementById('detailLoadingIndicator');
                if (detailLoadingIndicator) {
                    detailLoadingIndicator.style.display = 'none';
                }
            }, 100);

            // Show
            document.getElementById('home-view').style.display = 'none';
            document.getElementById('detail-view').style.display = 'block';
            window.scrollTo(0, 0);
            // setup gesture handling for multi-directional image swipe
            try { currentImageIndex = 0; setupDetailSliderGestures(); } catch (e) { /* ignore */ }
            // update like button state
            try { updateDetailLikeButton(); } catch (e) { /* ignore */ }
        }

        function closeDetail() {
            document.getElementById('detail-view').style.display = 'none';
            document.getElementById('home-view').style.display = 'block';
        }

        // Toggle like in detail view
        function toggleDetailLike(event) {
            event.preventDefault();
            const likeBtn = document.getElementById('lnk-like');
            const likeText = document.getElementById('like-text');
            const detailView = document.getElementById('detail-view');

            // Use a unique key: combination of main category + title
            const mainAttr = detailView.querySelector('[data-main]')?.getAttribute('data-main') || 'Unknown';
            const currentTitle = document.getElementById('dt-title').innerText;
            const uniqueKey = `${mainAttr}::${currentTitle}`;

            let likes = JSON.parse(localStorage.getItem('likes') || '{}');

            if (likes[uniqueKey]) {
                delete likes[uniqueKey];
                likeBtn.style.opacity = '0.8';
                likeText.textContent = 'Like';
            } else {
                likes[uniqueKey] = true;
                likeBtn.style.opacity = '1';
                likeText.textContent = 'Liked âœ“';
                // Play heart animation
                createFloatingHeart(event);
            }

            localStorage.setItem('likes', JSON.stringify(likes));
        }

        // Create floating heart animation
        function createFloatingHeart(event) {
            const heart = document.createElement('div');
            heart.classList.add('floating-heart');
            heart.textContent = 'â¤';

            // Position at button location
            const btn = document.getElementById('lnk-like');
            const rect = btn.getBoundingClientRect();
            heart.style.left = (rect.left + rect.width / 2) + 'px';
            heart.style.top = rect.top + 'px';
            heart.style.color = '#ef4444';

            document.body.appendChild(heart);

            // Remove after animation completes
            setTimeout(() => {
                heart.remove();
            }, 800);
        }

        // Check if current detail is liked and update button
        function updateDetailLikeButton() {
            const detailView = document.getElementById('detail-view');
            const mainAttr = detailView.querySelector('[data-main]')?.getAttribute('data-main') || 'Unknown';
            const currentTitle = document.getElementById('dt-title').innerText;
            const uniqueKey = `${mainAttr}::${currentTitle}`;

            let likes = JSON.parse(localStorage.getItem('likes') || '{}');
            const likeBtn = document.getElementById('lnk-like');
            const likeText = document.getElementById('like-text');

            if (likes[uniqueKey]) {
                likeBtn.style.opacity = '1';
                likeText.textContent = 'Liked âœ“';
            } else {
                likeBtn.style.opacity = '0.8';
                likeText.textContent = 'Like';
            }
        }

        // Handle swipe gestures in detail view slider (all 4 directions)
        let touchStartX = 0, touchStartY = 0;
        let currentImageIndex = 0;

        // Move to next/prev image in detail view
        function moveDetailImage(direction) {
            const slider = document.querySelector('.dt-slider-box .card-slider');
            if (!slider) return;

            const images = slider.querySelectorAll('img');
            const totalImages = images.length;
            if (totalImages === 0) return;

            currentImageIndex = (currentImageIndex + direction + totalImages) % totalImages;

            // Scroll to the selected image
            if (images[currentImageIndex]) {
                images[currentImageIndex].scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'nearest' });
            }
        }

        function handleDetailSliderSwipe(e) {
            const slider = e.currentTarget;
            if (!slider) return;

            const touchEndX = e.changedTouches ? e.changedTouches[0].clientX : e.clientX;
            const touchEndY = e.changedTouches ? e.changedTouches[0].clientY : e.clientY;

            const diffX = touchStartX - touchEndX;
            const diffY = touchStartY - touchEndY;

            const images = slider.querySelectorAll('img');
            const totalImages = images.length;

            if (Math.abs(diffX) > Math.abs(diffY)) {
                // Horizontal swipe
                if (diffX > 50) {
                    // Swipe left â†’ next image
                    currentImageIndex = (currentImageIndex + 1) % totalImages;
                } else if (diffX < -50) {
                    // Swipe right â†’ prev image
                    currentImageIndex = (currentImageIndex - 1 + totalImages) % totalImages;
                }
            } else {
                // Vertical swipe
                if (diffY > 50) {
                    // Swipe up â†’ next image
                    currentImageIndex = (currentImageIndex + 1) % totalImages;
                } else if (diffY < -50) {
                    // Swipe down â†’ prev image
                    currentImageIndex = (currentImageIndex - 1 + totalImages) % totalImages;
                }
            }

            // Scroll to the selected image
            if (images[currentImageIndex]) {
                images[currentImageIndex].scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'nearest' });
            }
        }

        function setupDetailSliderGestures() {
            const slider = document.querySelector('.dt-slider-box .card-slider');
            if (!slider) return;

            // Remove old listeners first to prevent duplicates
            const newSlider = slider.cloneNode(true);
            slider.parentNode.replaceChild(newSlider, slider);

            const updatedSlider = document.querySelector('.dt-slider-box .card-slider');
            updatedSlider.addEventListener('touchstart', (e) => {
                touchStartX = e.touches[0].clientX;
                touchStartY = e.touches[0].clientY;
            });
            updatedSlider.addEventListener('touchend', handleDetailSliderSwipe);

            // Optional: support mouse drag on desktop
            updatedSlider.addEventListener('mousedown', (e) => {
                touchStartX = e.clientX;
                touchStartY = e.clientY;
            });
            updatedSlider.addEventListener('mouseup', handleDetailSliderSwipe);
        }
        // stop autoscroll when closing detail
        const originalCloseDetail = closeDetail;
        window.closeDetail = function () {
            stopRelatedAutoscroll();
            try { originalCloseDetail(); } catch (e) { /* ignore */ }
        }

        // RELATED SCROLL: autoplay vertically (like YouTube feed) and click-to-open behavior
        let relatedAutoScrollInterval = null;

        function initRelatedCarousel(currentTitle) {
            const grid = document.getElementById('related-grid');
            if (!grid) return;

            // Make it a vertical stack so full cards are visible and the page can scroll naturally
            grid.style.display = 'block';
            // Let the page handle vertical scrolling so full shop details are visible
            grid.style.overflowY = 'visible';
            grid.style.maxHeight = '';
            grid.style.gap = '';
            grid.style.padding = '8px 0';

            // Ensure cards stack vertically and take full width
            const cards = grid.querySelectorAll('.card');
            cards.forEach(c => {
                c.style.minWidth = '';
                c.style.width = '100%';
                c.style.flex = '';
                c.style.margin = '0 0 12px 0';
                // Highlight the currently opened item (optional)
                if (currentTitle && c.getAttribute('data-title') === currentTitle) {
                    c.style.outline = '3px solid rgba(37,99,235,0.12)';
                } else {
                    c.style.outline = 'none';
                }
            });

            // Delegate click: open related card in detail view (and enter fullscreen)
            grid.removeEventListener('click', relatedClickHandler);
            grid.addEventListener('click', relatedClickHandler);

            // We will not auto-scroll here to allow users to scroll the full list naturally.
            stopRelatedAutoscroll();
        }

        function stopRelatedAutoscroll() {
            if (relatedAutoScrollInterval) { clearInterval(relatedAutoScrollInterval); relatedAutoScrollInterval = null; }
        }

        function relatedClickHandler(e) {
            const card = e.target.closest('.card');
            if (!card) return;
            // open detail for this card
            stopRelatedAutoscroll();
            openDetail(card);
            // attempt to go fullscreen for the detail view (like opening a video)
            const dv = document.getElementById('detail-view');
            try {
                if (dv.requestFullscreen) dv.requestFullscreen();
            } catch (err) {
                // ignore if fullscreen fails
            }
        }



        // Banner Slider Functionality
        let bannerIndex = 0;
        const slides = document.querySelectorAll('.banner-slide');
        const indicators = document.querySelectorAll('.banner-indicator');

        function showBanner(n) {
            bannerIndex += n;
            if (bannerIndex >= slides.length) { bannerIndex = 0; }
            if (bannerIndex < 0) { bannerIndex = slides.length - 1; }

            slides.forEach(slide => slide.classList.remove('active'));
            indicators.forEach(indicator => indicator.classList.remove('active'));

            slides[bannerIndex].classList.add('active');
            indicators[bannerIndex].classList.add('active');
        }

        function currentBanner(n) {
            bannerIndex = n;
            slides.forEach(slide => slide.classList.remove('active'));
            indicators.forEach(indicator => indicator.classList.remove('active'));

            slides[bannerIndex].classList.add('active');
            indicators[bannerIndex].classList.add('active');
        }

        // Auto slide banner every 5 seconds
        setInterval(() => {
            showBanner(1);
        }, 5000);

        // Theme toggle functionality
        function toggleTheme() {
            const html = document.documentElement;
            const isDarkMode = html.classList.toggle('dark-mode');

            // Save preference to localStorage
            localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');

            // Update icon
            const toggleBtn = document.querySelector('.theme-toggle i');
            if (toggleBtn) {
                toggleBtn.classList.toggle('fa-moon');
                toggleBtn.classList.toggle('fa-sun');
            }
        }

        // Restore theme on page load
        document.addEventListener('DOMContentLoaded', function () {
            const savedTheme = localStorage.getItem('theme') || 'light';
            if (savedTheme === 'dark') {
                document.documentElement.classList.add('dark-mode');
                const toggleBtn = document.querySelector('.theme-toggle i');
                if (toggleBtn) {
                    toggleBtn.classList.remove('fa-moon');
                    toggleBtn.classList.add('fa-sun');
                }
            }
        });
    </script>
    <script>
        // Hide any h1 elements with text content 'X'
        document.addEventListener('DOMContentLoaded', function () {
            const h1Elements = document.querySelectorAll('h1');
            h1Elements.forEach(function (h1) {
                if (h1.textContent.trim() === 'X') {
                    h1.style.display = 'none';
                }
            });
        });
    </script>
    <script>
        /*
         Dynamic external section loader
         - Attempts to fetch an external HTML file (e.g. gaming.html)
         - Parses its .card elements and injects them into this page's #mainGrid
         - Removes existing cards with the same data-main attribute to avoid duplicates
         - Falls back to embedding an iframe if fetch is blocked (common when opening files with file://)
        */

        /*
         Dynamic external section loader
         - Attempts to fetch an external HTML file (e.g. gaming.html)
         - Parses its .card elements and injects them into this page's #mainGrid
         - Falls back to embedding an iframe if fetch is blocked
        */








        (function () {
            async function loadExternalCards(url, mainAttr = 'Gaming') {
                const mainGrid = document.getElementById('mainGrid');
                if (!mainGrid) return;

                // Note: We do NOT clear existing cards in '*' wildcard mode, to allow aggregation.

                try {
                    const fetchUrl = url + ((url.indexOf('?') === -1) ? '?_=' + Date.now() : '&_=' + Date.now());
                    const res = await fetch(fetchUrl);
                    if (!res.ok) throw new Error('Fetch failed: ' + res.status);
                    const text = await res.text();
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(text, 'text/html');

                    const externalCards = doc.querySelectorAll('.card');
                    if (!externalCards || externalCards.length === 0) return true;

                    externalCards.forEach(ec => {
                        if (mainAttr === '*' || ec.getAttribute('data-main') === mainAttr) {
                            if (mainAttr === '*') {
                                const title = ec.getAttribute('data-title');
                                const exists = Array.from(mainGrid.querySelectorAll('.card')).some(existing => existing.getAttribute('data-title') === title);
                                if (exists) return; // avoid duplicates
                            }

                            // Ensure data-pin schema
                            if (!ec.hasAttribute('data-pin')) ec.setAttribute('data-pin', '');

                            const imported = document.importNode(ec, true);
                            mainGrid.appendChild(imported);
                        }
                    });
                    return true;
                } catch (err) {
                    // console.warn('Could not fetch', url);
                    return false;
                }
            }
            window.loadExternalCards = loadExternalCards;

            document.addEventListener('DOMContentLoaded', async function () {
                // List of ALL external files
                const allContentFiles = [
                    'trending.html', 'gaming.html', 'content-creators.html', 'market.html',
                    'food.html', 'services.html', 'health.html', 'education.html',
                    'property.html', 'travel.html', 'khurja-special.html',
                    'events.html', 'emergency.html', 'religion.html', 'businesses.html', 'jobs.html'
                ];

                if (window.loadExternalCards) {
                    try {
                        const promises = allContentFiles.map(file =>
                            window.loadExternalCards(file, '*').catch(e => { })
                        );
                        await Promise.all(promises);
                    } catch (err) {
                        console.warn('Major error aggregating content:', err);
                    } finally {
                        // Shuffle AFTER all loads
                        try { if (window.shuffleMainGrid) window.shuffleMainGrid(); } catch (e) { }
                    }
                }
            });
        })();


    </script>



    <!-- SPIN & WIN BUTTON -->
    <div class="spin-trigger-btn" onclick="openSpinWin()">
        <i class="fas fa-dharmachakra"></i>
    </div>

    <!-- SPIN MODAL (PREMIUM) -->
    <div id="spin-win-modal" class="sw-modal">
        <div class="sw-content scale-in">
            <button class="sw-close" onclick="closeSpinWin()">&times;</button>
            <h2 class="sw-title">SPIN & WIN BIG</h2>

            <div class="sw-game-area">

                <!-- SETTINGS BUTTON -->
                <div class="sw-settings-btn" onclick="toggleProbabilities()">
                    <i class="fas fa-cog"></i>
                </div>

                <!-- PROBABILITY MODAL OVERLAY -->
                <div id="sw-prob-modal" class="sw-prob-modal">
                    <div class="sw-prob-title">Win Probability</div>

                    <div class="sw-prob-row">
                        <span class="sw-prob-label">FREE BILL</span>
                        <span class="sw-prob-val rare">10%</span>
                    </div>
                    <div class="sw-prob-row">
                        <span class="sw-prob-label">50% OFF</span>
                        <span class="sw-prob-val">15%</span>
                    </div>
                    <div class="sw-prob-row">
                        <span class="sw-prob-label">10% OFF</span>
                        <span class="sw-prob-val">25%</span>
                    </div>
                    <div class="sw-prob-row">
                        <span class="sw-prob-label">TRY AGAIN</span>
                        <span class="sw-prob-val common">50%</span>
                    </div>

                    <div style="margin-top: 15px; font-size: 0.8rem; color: #888;">
                        *System verified fair play algorithm.
                    </div>

                    <button class="sw-prob-close" onclick="toggleProbabilities()">CLOSE</button>
                </div>
                <div class="sw-pointer-wrapper">
                    <div class="sw-pointer"></div>
                </div>

                <!-- OUTER BEZEL -->
                <div class="sw-wheel-outer">
                    <!-- LIGHTS -->
                    <div class="sw-dot" style="--d:0"></div>
                    <div class="sw-dot" style="--d:1"></div>
                    <div class="sw-dot" style="--d:2"></div>
                    <div class="sw-dot" style="--d:3"></div>
                    <div class="sw-dot" style="--d:4"></div>
                    <div class="sw-dot" style="--d:5"></div>
                    <div class="sw-dot" style="--d:6"></div>
                    <div class="sw-dot" style="--d:7"></div>

                    <!-- INNER WHEEL -->
                    <div class="sw-wheel" id="sw-wheel">
                        <!-- 4 SEGMENTS (90deg each) -->
                        <div class="sw-seg" style="--i:0;"><span>FREE<br>BILL</span></div>
                        <div class="sw-seg" style="--i:1;"><span>50%<br>OFF</span></div>
                        <div class="sw-seg" style="--i:2;"><span>10%<br>OFF</span></div>
                        <div class="sw-seg" style="--i:3;"><span>TRY<br>AGAIN</span></div>
                    </div>

                    <!-- CENTER CAP -->
                    <div class="sw-center-hub">
                        <div class="sw-center-star">â˜…</div>
                    </div>
                </div>
            </div>

            <!-- REDEEM SECTION -->
            <div id="sw-redeem-section" class="sw-redeem-box">
                <!-- DYNAMIC CONTENT -->
            </div>

            <div id="sw-result" class="sw-result"></div>
        </div>
    </div>

    <style>
        /* TRIGGER BUTTON */
        .spin-trigger-btn {
            position: fixed;
            bottom: 85px;
            right: 20px;
            width: 65px;
            height: 65px;
            background: radial-gradient(circle at 30% 30%, #ffd700, #f59e0b);
            border: 3px solid #fff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #b45309;
            font-size: 2.2rem;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4), inset 0 0 10px rgba(255, 255, 255, 0.5);
            cursor: pointer;
            z-index: 1000;
            animation: float-btn 3s ease-in-out infinite;
        }

        @keyframes float-btn {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-5px);
            }
        }

        /* MODAL */
        .sw-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(8px);
        }

        .sw-modal.show {
            display: flex;
        }

        .sw-content {
            background: linear-gradient(145deg, #ffffff, #f0f0f0);
            width: 95%;
            max-width: 380px;
            border-radius: 24px;
            padding: 25px 15px;
            text-align: center;
            position: relative;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .sw-close {
            position: absolute;
            top: 10px;
            right: 15px;
            background: #eee;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #555;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sw-title {
            margin-bottom: 25px;
            font-weight: 900;
            background: linear-gradient(to right, #cf0000, #ff0000);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 1.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* WHEEL CONTAINER */
        .sw-game-area {
            position: relative;
            margin: 0 auto 20px;
            width: 280px;
            height: 280px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* BEZEL (Outer Ring) */
        .sw-wheel-outer {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: radial-gradient(circle, #444 60%, #222 100%);
            padding: 12px;
            /* Rim thickness */
            position: relative;
            box-shadow:
                0 10px 20px rgba(0, 0, 0, 0.5),
                inset 0 0 15px rgba(0, 0, 0, 0.8);
            border: 4px solid #f59e0b;
            /* Gold trim */
        }

        /* DECORATIVE DOTS */
        .sw-dot {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #fff;
            border-radius: 50%;
            top: 50%;
            left: 50%;
            margin-top: -5px;
            margin-left: -5px;
            box-shadow: 0 0 5px #fff, 0 0 10px #f59e0b;
            transform: rotate(calc(45deg * var(--d))) translate(132px) rotate(calc(-45deg * var(--d)));
            /* Place on rim */
            animation: blink 1s infinite alternate;
            animation-delay: calc(0.1s * var(--d));
        }

        @keyframes blink {
            from {
                opacity: 0.3;
            }

            to {
                opacity: 1;
                transform: rotate(calc(45deg * var(--d))) translate(132px) scale(1.2);
            }
        }

        /* THE ROTATING WHEEL */
        .sw-wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            overflow: hidden;
            position: relative;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            /* Conic Gradient for 4 segments */
            background: conic-gradient(#ef4444 0% 25%,
                    /* Red */
                    #3b82f6 25% 50%,
                    /* Blue */
                    #10b981 50% 75%,
                    /* Green */
                    #f59e0b 75% 100%
                    /* Orange */
                );
            transition: transform 8s cubic-bezier(0.25, 0.1, 0.25, 1);
        }

        /* SEGMENTS TEXT */
        .sw-seg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            clip-path: none;
            text-align: center;
        }

        .sw-seg span {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.9rem;
            font-weight: 800;
            color: #fff;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
            line-height: 1.1;
        }

        /* Rotate text for each quadrant */
        /* Rotate text for each quadrant (Center of wedge) */
        .sw-seg span {
            transform: translate(-50%, -50%) rotate(calc(90deg * var(--i) + 45deg)) translate(0, -85px);
            /* Reset top/left to center for the transform to work from */
            top: 50%;
            left: 50%;
        }

        /* Left Orange */

        /* CENTER HUB */
        .sw-center-hub {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50px;
            height: 50px;
            background: radial-gradient(circle at 30% 30%, #fff, #ddd);
            border-radius: 50%;
            border: 4px solid #fff;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        .sw-center-star {
            color: #f59e0b;
            font-size: 1.5rem;
        }

        /* POINTER */
        .sw-pointer-wrapper {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 20;
            filter: drop-shadow(0 4px 2px rgba(0, 0, 0, 0.3));
        }

        .sw-pointer {
            width: 30px;
            height: 40px;
            background: #333;
            clip-path: polygon(50% 100%, 0 0, 100% 0);
        }

        /* SETTINGS BUTTON CODE BLOCK */
        /* Note: Styles are already added */


        /* INPUT BOX */
        .sw-redeem-box {
            background: #fff;
            border: 2px solid #e5e7eb;
            margin-top: 15px;
            padding: 20px;
            border-radius: 16px;
            position: relative;
            z-index: 50;
        }

        /* SETTINGS BUTTON */
        .sw-settings-btn {
            position: absolute;
            bottom: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.4);
            color: #fff;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 100;
            transition: 0.3s;
        }

        .sw-settings-btn:hover {
            background: rgba(255, 255, 255, 0.4);
            transform: rotate(90deg);
        }

        /* PROBABILITY MODAL OVERLAY */
        #sw-prob-modal {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 200;
            display: none;
            /* Hidden by default */
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #fff;
            padding: 20px;
            text-align: center;
        }

        #sw-prob-modal.show {
            display: flex;
        }

        .sw-input {
            width: 100%;
            padding: 14px;
            font-size: 1.1rem;
            border: 2px solid #ddd;
            border-radius: 10px;
            margin-bottom: 12px;
            text-align: center;
            text-transform: uppercase;
            font-weight: 700;
            letter-spacing: 1px;
            transition: 0.3s;
            position: relative;
            z-index: 60;
        }

        .sw-input:focus {
            border-color: #f59e0b;
            outline: none;
            box-shadow: 0 0 0 4px rgba(245, 158, 11, 0.2);
        }

        .sw-btn {
            background: linear-gradient(to right, #2563eb, #1d4ed8);
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 10px;
            color: #fff;
            font-weight: 800;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            box-shadow: 0 4px 0 #1e40af;
        }

        .sw-btn:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0 #1e40af;
        }

        .sw-btn:disabled {
            background: #9ca3af;
            box-shadow: none;
            cursor: not-allowed;
        }

        /* Active State */
        .sw-status-active {
            color: #10b981;
            font-size: 1.4rem;
            font-weight: 900;
            margin-bottom: 5px;
        }

        .sw-timer {
            font-family: 'Courier New', monospace;
            font-size: 1.2rem;
            font-weight: 700;
            color: #4b5563;
            background: #f3f4f6;
            padding: 5px 10px;
            border-radius: 5px;
            display: inline-block;
        }

        /* SETTINGS BUTTON & MODAL */
        .sw-settings-btn {
            position: absolute;
            bottom: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.4);
            color: #fff;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 100;
            transition: 0.3s;
        }

        .sw-settings-btn:hover {
            background: rgba(255, 255, 255, 0.4);
            transform: rotate(90deg);
        }

        .sw-prob-modal {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 200;
            display: none;
            /* Hidden by default */
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #fff;
            padding: 20px;
            text-align: center;
        }

        .sw-prob-modal.show {
            display: flex;
        }

        .sw-prob-title {
            font-size: 1.5rem;
            font-weight: 800;
            margin-bottom: 20px;
            color: #f59e0b;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 2px solid #f59e0b;
            padding-bottom: 10px;
        }

        .sw-prob-row {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 300px;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 1rem;
        }

        .sw-prob-label {
            font-weight: 600;
            color: #ddd;
        }

        .sw-prob-val {
            font-weight: 800;
            color: #10b981;
            font-family: 'Courier New', monospace;
        }

        .sw-prob-val.rare {
            color: #f59e0b;
        }

        .sw-prob-val.common {
            color: #ef4444;
        }

        .sw-prob-close {
            margin-top: 30px;
            padding: 10px 30px;
            background: #333;
            border: 1px solid #555;
            color: #fff;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 700;
        }
    </style>

    <script>
        // --- SPIN & WIN LOGIC ---
        (function () {
            const LOCK_DURATION = 10 * 1000; // 10 Seconds (User Request)
            let spinInterval;
            window.isCodeVisible = false; // Visibility state for Eye Button

            window.toggleProbabilities = () => {
                const modal = document.getElementById('sw-prob-modal');
                modal.classList.toggle('show');
            };

            window.toggleCodeVisibility = (code) => {
                window.isCodeVisible = !window.isCodeVisible;
                // Re-render only if modal is open, or it will auto-update on next interval
                _checkRedeemStatus();
            };

            window.openSpinWin = () => {
                document.getElementById('spin-win-modal').classList.add('show');
                _checkRedeemStatus();
                // Check status every second while modal is open
                spinInterval = setInterval(_checkRedeemStatus, 1000);
            };

            window.closeSpinWin = () => {
                document.getElementById('spin-win-modal').classList.remove('show');
                clearInterval(spinInterval);
            };

            // 1. Check Status
            window._checkRedeemStatus = () => {
                const lastRedeem = localStorage.getItem('sw_last_redeem_v3');
                const lastCode = localStorage.getItem('sw_active_code_v3');
                const now = Date.now();
                let isActive = false;
                let timeLeft = 0;

                if (lastRedeem) {
                    const diff = now - parseInt(lastRedeem);
                    if (diff < LOCK_DURATION) {
                        isActive = true;
                        timeLeft = LOCK_DURATION - diff;
                    } else {
                        // Expired
                        localStorage.removeItem('sw_active_code_v3');
                        localStorage.removeItem('sw_last_result_v3'); // Clear saved result
                        document.getElementById('sw-result').innerText = ""; // Clear visual result text
                    }
                }

                _buildRedeemCodeSection(isActive, timeLeft, lastCode);
            };

            // 2. Build UI
            function _buildRedeemCodeSection(isActive, timeLeft, lastCode) {
                const container = document.getElementById('sw-redeem-section');

                // OPTIMIZATION: Prevent re-rendering input if already exists (fixes focus loss)
                const existingInput = document.getElementById('sw-code-input');

                if (isActive) {
                    // Update timer UI every second
                    // Calculate Hours, Mins, Secs
                    const h = Math.floor(timeLeft / (1000 * 60 * 60));
                    const m = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                    const s = Math.floor((timeLeft % (1000 * 60)) / 1000);

                    container.innerHTML = `
                        <div class="sw-status-active">Code Active <i class="fas fa-check-circle"></i></div>
                        <div class="sw-timer">Refresh within: ${h}h ${m}m ${s}s</div>
                        <div style="margin-top:10px; font-size:0.9rem; color:#666; display:flex; align-items:center; justify-content:center; gap:8px;">
                            Active Code: 
                            <strong id="sw-active-code-display">${window.isCodeVisible ? lastCode : '*******'}</strong>
                            <button onclick="toggleCodeVisibility('${lastCode}')" style="background:none; border:none; cursor:pointer; color:#666; padding:0; font-size:1rem;">
                                <i class="fas ${window.isCodeVisible ? 'fa-eye-slash' : 'fa-eye'}"></i>
                            </button>
                        </div>
                        <div style="margin-top:8px; font-size:0.9rem; font-weight:bold; color:#333;">
                            Your Reward: <span style="color:#d97706;">${localStorage.getItem('sw_last_result_v3') || 'Spinning...'}</span>
                        </div>
                        <button class="sw-btn" disabled style="margin-top:10px; background:#9ca3af; cursor: not-allowed;">LOCKED (Wait for Timer)</button>
                    `;
                } else {
                    // If not active, show input form
                    // Only render if input doesn't exist to prevent overwriting focus
                    if (!existingInput) {
                        container.innerHTML = `
                            <input type="text" id="sw-code-input" class="sw-input" placeholder="Enter Code">
                            <button class="sw-btn" onclick="_redeemCode()">REDEEM CODE</button>
                            <p id="sw-err-msg" style="color:red; font-size:0.8rem; margin-top:5px; display:none;"></p>
                        `;
                    }
                }
            }

            // 3. Redeem Logic
            window._redeemCode = () => {
                const input = document.getElementById('sw-code-input');
                const errMsg = document.getElementById('sw-err-msg');
                const code = input.value.trim().toUpperCase();

                // Validation: Must contain KHURJAX followed by 4 digits
                // User Example: FOOKHURJAX1234. Logic: Search for KHURJAX(\d{4})
                const match = code.match(/KHURJAX(\d{4})/);

                if (!match) {
                    showError("Invalid Code"); // Generic error (User Request: "YE NAHI BATAYE")
                    return;
                }

                const num = parseInt(match[1]); // The 4 digits

                // Number Range Check: 1000 - 9999 (User Request)
                if (num >= 1000 && num <= 9999) {
                    // Valid!
                    // Activation
                    localStorage.setItem('sw_last_redeem_v3', Date.now().toString());
                    localStorage.setItem('sw_active_code_v3', code);

                    // Trigger "Spin" visual as feedback (Optional per request, but good UX)
                    // The user said "Chahe user jeete ya haare... Active mark ho jata hai"
                    // We will just active it and show the UI update.

                    _checkRedeemStatus(); // Update UI immediately

                    // Auto-spin or let user spin? I added a Spin button in Active UI.
                    // Let's auto-spin for effect.
                    triggerSpin();

                } else {
                    showError("Invalid Code"); // Generic error for range mismatch too
                }

                function showError(msg) {
                    errMsg.innerText = msg;
                    errMsg.style.display = 'block';
                    input.style.borderColor = 'red';
                    // Clear any previous result
                    document.getElementById('sw-result').innerText = "";
                }
            };

            window.triggerSpin = () => {
                const wheel = document.getElementById('sw-wheel');
                const res = document.getElementById('sw-result');
                res.innerText = "Spinning...";

                let targetAngle;
                let resultText;

                // ALWAYS LOSE (User Request: "SAB REMOVE KARO HAR BAAR LOSE HI HO")
                // NEAR MISS EFFECT (User Request: "AESA LAGE KI WAH FREE BILL PAR RUKEGA LEKIN WAH TRY AGYEN PAR RUKE")
                // Strategy: Land on "TRY AGAIN" (Segment 3: 270-360) but close to "FREE BILL" (Segment 0: 0-90).
                // The Boundary is 0/360.
                // If we rotate +15 degrees: 
                // The pointer (Top) effectively lands on 345 degrees (Inside "TRY AGAIN").
                // "FREE BILL" starts at 0, so it's just 15 degrees away. Visually very close.

                targetAngle = 15;
                resultText = "Result: SO CLOSE! BETTER LUCK NEXT TIME!";

                // Get current rotation or default to 0
                let currentRot = parseFloat(wheel.getAttribute('data-rotation')) || 0;

                // Add random full spins (Increased base spins for 8s duration)
                const extraSpins = 3600 + (Math.floor(Math.random() * 5) * 360);

                // Add jitter (+/- 5deg) to make it look less robotic, but stay within wedge
                const jitter = Math.floor(Math.random() * 5);

                // Calculate spin to land on target:
                // We want (finalRot % 360) â‰ˆ targetAngle.
                // Let base = currentRot + 1800 (min spins).

                const minSpins = 10 * 360; // minimum spin distance for 8s
                let newRot = currentRot + minSpins;
                const remainder = newRot % 360;
                // We want remainder to be targetAngle.
                const diff = targetAngle - remainder;
                newRot += diff;

                // Ensure it's always positive forward spin
                if (newRot <= currentRot) newRot += 360;

                newRot += jitter;

                wheel.style.transform = `rotate(${newRot}deg)`;
                wheel.setAttribute('data-rotation', newRot);

                setTimeout(() => {
                    res.innerText = resultText;

                    // Save result for persistence
                    const cleanResult = resultText.replace("Result: ", "");
                    localStorage.setItem('sw_last_result_v3', cleanResult);

                    if (resultText.includes("CONGRATULATIONS")) {
                        // Optional: confetti or celebration effect here
                        res.style.color = "#10b981";
                    } else {
                        res.style.color = "#ef4444";
                    }

                    // Update UI to show saved result in the redeem box
                    _checkRedeemStatus();

                }, 8000); // 8 Seconds (User Request)
            };
        })();
    </script>
</body>

</html>
